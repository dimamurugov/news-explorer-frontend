!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){"use strict";n.r(t),n.d(t,"myServerConfig",(function(){return r})),n.d(t,"newsApiConfig",(function(){return s}));const r={baseUrl:"https://api.murnews.students.nomoreparties.xyz",headers:{"Content-Type":"application/json"}},s={baseUrl:"https://nomoreparties.co/news/v2/everything?",apiKey:"e487423936f948508cbe9646373e3ac5",pageSize:100,language:"ru",sortBy:"popularity",days:7}},function(e,t,n){"use strict";n.r(t),n.d(t,"formLogIn",(function(){return r})),n.d(t,"popupLogIn",(function(){return s})),n.d(t,"buttonLogIn",(function(){return i})),n.d(t,"buttonLoginInForm",(function(){return o})),n.d(t,"logInAnswerMessage",(function(){return a})),n.d(t,"formSignUp",(function(){return c})),n.d(t,"popupSignUp",(function(){return u})),n.d(t,"buttonSignUp",(function(){return d})),n.d(t,"signUpAnswerMessage",(function(){return l})),n.d(t,"buttonLoginInMessageDone",(function(){return h})),n.d(t,"popupDone",(function(){return _})),n.d(t,"buttonLogOutUser",(function(){return g})),n.d(t,"buttonSavePage",(function(){return m})),n.d(t,"buutonSearch",(function(){return p})),n.d(t,"formSearch",(function(){return f})),n.d(t,"answerSearchMessage",(function(){return b})),n.d(t,"baseTime",(function(){return v})),n.d(t,"months",(function(){return S})),n.d(t,"preloaderLoading",(function(){return y})),n.d(t,"preloaderNothing",(function(){return C})),n.d(t,"container",(function(){return L})),n.d(t,"sectionNews",(function(){return I})),n.d(t,"showMoreButton",(function(){return M})),n.d(t,"userName",(function(){return w})),n.d(t,"countArticles",(function(){return k})),n.d(t,"keyWords",(function(){return q})),n.d(t,"countKeyWords",(function(){return A})),n.d(t,"buttonBurger",(function(){return x})),n.d(t,"mobileMenu",(function(){return P})),n.d(t,"buttonCloseMenu",(function(){return U}));const r=document.querySelector(".popup__form_theme_signin"),s=document.querySelector(".popup_theme_signin"),i=document.querySelector(".header__signin_theme_button-avtorization"),o=document.querySelector(".button__logIn-form"),a=document.querySelector(".popup__error-message_theme_signin"),c=document.querySelector(".popup__form_theme_signup"),u=document.querySelector(".popup_theme_signup"),d=document.querySelector(".button__signUp"),l=document.querySelector(".popup__error-message_theme_signup"),h=document.querySelector(".popup_link_theme_done"),_=document.querySelector(".popup_theme_done"),g=document.querySelector(".header__signin_theme_button-user"),m=document.querySelector(".header__list-item_type_save-page"),p=document.querySelector(".search__button"),f=document.querySelector(".search__form"),b=document.querySelector(".search__error-message"),v={min:60,sec:60,ms:1e3},S=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],y=document.querySelector(".preloader__loading"),C=document.querySelector(".preloader__nothing"),L=document.querySelector(".place-list"),I=document.querySelector(".news-content"),M=document.querySelector(".news-content__button-uncover"),w=document.querySelector(".profile__user-name"),k=document.querySelector(".profile__count-Articles"),q=document.querySelector(".profile__key-word"),A=document.querySelector(".profile__count-topics"),x=document.querySelector(".header__burger"),P=document.querySelector(".menu"),U=document.querySelector(".menu__close")},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(0),s=n(1);function i(){const e=r.newsApiConfig.days*s.baseTime.min*s.baseTime.sec*s.baseTime.ms,t=new Date,n=t.toISOString();return{fromDate:new Date(t.getTime()-e).toISOString(),toDate:n}}function o(e){return new URLSearchParams({q:e,from:i().fromDate,to:i().tromDate,language:r.newsApiConfig.language,pageSize:r.newsApiConfig.pageSize,apiKey:r.newsApiConfig.apiKey}).toString()}function a(e){const t=new Date(e);return`${t.getDate()} ${s.months[t.getMonth()]}, ${t.getFullYear()}`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.url=e.baseUrl,this.headers=e.headers}signup(e,t,n){return fetch(this.url+"/signup",{method:"POST",headers:this.headers,body:JSON.stringify({name:e,email:t,password:n})}).then(e=>this._checkResponseValidity(e))}signin(e,t){return fetch(this.url+"/signin",{method:"POST",credentials:"include",headers:this.headers,body:JSON.stringify({email:e,password:t})}).then(e=>this._checkResponseValidity(e))}getUserArticles(){return fetch(this.url+"/articles",{method:"GET",headers:this.headers,credentials:"include"}).then(e=>this._checkResponseValidity(e))}createArticle({keyword:e,title:t,text:n,date:r,source:s,link:i,image:o}){return fetch(this.url+"/articles",{method:"POST",headers:this.headers,credentials:"include",body:JSON.stringify({keyword:e,title:t,text:n,date:r,source:s,link:i,image:o})}).then(e=>this._checkResponseValidity(e))}deleteArticleUser(e){return fetch(`${this.url}/articles/${e}`,{method:"DELETE",headers:this.headers,credentials:"include"}).then(e=>this._checkResponseValidity(e))}getUserMe(){return fetch(this.url+"/users/me",{method:"GET",headers:this.headers,credentials:"include"}).then(e=>this._checkResponseValidity(e))}getIdArticle(e){return this.getUserArticles().then(t=>t.data.find(t=>t.link===e))}_checkResponseValidity(e){return e.ok?e.json():e.json().then(Promise.reject.bind(Promise))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e){this.buttonSavePage=e.buttonSavePage,this.buttonUser=e.buttonUser,this.buttonLogIn=e.buttonLogIn,this.buttonBurger=e.buttonBurger,this.mobileMenu=e.mobileMenu,this.buttonCloseMenu=e.buttonCloseMenu,this.openMobileMenu=this.openMobileMenu.bind(this),this.closeMobileMenu=this.closeMobileMenu.bind(this),this.setListeners()}render(e){if(e.isLoggedIn)return this.buttonSavePage.classList.add("header__signin_state_action"),this.buttonLogIn.classList.remove("header__signin_state_action"),this.buttonUser.classList.add("header__signin_state_action"),void(this.buttonUser.textContent=e.userName);this.buttonSavePage.classList.remove("header__signin_state_action"),this.buttonLogIn.classList.add("header__signin_state_action"),this.buttonUser.classList.remove("header__signin_state_action")}openMobileMenu(){this.mobileMenu.classList.add("menu_action_open")}closeMobileMenu(){this.mobileMenu.classList.remove("menu_action_open")}setListeners(){this.buttonBurger.addEventListener("click",this.openMobileMenu),this.buttonCloseMenu.addEventListener("click",this.closeMobileMenu)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){}getUserData(){const e=localStorage.getItem("user");return""===e?"":JSON.parse(e)}clearUserInfo(){localStorage.setItem("user","")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2);class s{constructor(e,t,n,r){this.data=e,this.isAuth=t,this.api=n,this.saveArticle=this.saveArticle.bind(this),this.deleteCardSavePage=this.deleteCardSavePage.bind(this)}templateCard(){const e=document.createElement("div");return e.insertAdjacentHTML("beforeend",'\n    <div class="card">\n      <div class="card__image card__image_theme_index-page" style="background-image:">\n        <button class="card__button"></button>\n      </div>\n      <div class="card__description">\n        <p class="card__time">2 августа, 2019</p>\n        <h3 class="card__title">Национальное достояние – парки</h3>\n        <p class="card__text">В 2016 году Америка отмечала важный юбилей: сто лет назад здесь начала складыв...</p>\n        <p class="card__author">Лента.ру</p>\n      </div>\n    </div>'),e}create(){const e=this.templateCard();let t;return this.imageCard=e.querySelector(".card__image"),this.dateCard=e.querySelector(".card__time"),this.titleCard=e.querySelector(".card__title"),this.textCard=e.querySelector(".card__text"),this.authorCard=e.querySelector(".card__author"),this.saveIcon=e.querySelector(".card__button"),t=void 0===this.data.urlToImage?"url(../../images/placeholder.png)":`url(${this.data.urlToImage})`,this.imageCard.style.backgroundImage=t,this.dateCard.textContent=Object(r.a)(this.data.publishedAt),this.titleCard.textContent=this.data.title,this.textCard.textContent=this.data.description,this.authorCard.textContent=this.data.source.name,this._renderIconSave(),this.placeCard=e.firstElementChild,this.placeCard}createArticleSavePage(){const e=this.templateCard();let t;return this.imageCard=e.querySelector(".card__image"),this.dateCard=e.querySelector(".card__time"),this.titleCard=e.querySelector(".card__title"),this.textCard=e.querySelector(".card__text"),this.authorCard=e.querySelector(".card__author"),this.saveIcon=e.querySelector(".card__button"),this.imageCard.insertAdjacentHTML("afterbegin",'<div><p class="card__teg">Природа</p></div>'),this.imageCard.classList.remove("card__image_theme_index-page"),this.tag=e.querySelector(".card__teg"),t=void 0===this.data.image?"url(https://серебро.рф/img/placeholder.png)":`url(${this.data.image})`,this.imageCard.style.backgroundImage=t,this.tag.textContent=this.data.keyword,this.dateCard.textContent=this.data.date,this.titleCard.textContent=this.data.title,this.textCard.textContent=this.data.text,this.authorCard.textContent=this.data.source,this.saveIcon.classList.add("card__button_action_delete"),this.setListenersSavePage(),this.placeCard=e.firstElementChild,this.placeCard}delete(){console.log(this),this.api.deleteArticleUser(this.data._id).then(e=>{console.log(e)})}deleteCardSavePage(e){const t=this.placeCard.closest(".card");e.stopPropagation(),t.remove(),this.delete(),location.reload(),this.removeListernesSavePage()}saveArticle(){if(this.saveIcon.classList.contains("card__button_action_click"))this.saveIcon.classList.remove("card__button_action_click"),this.delete();else{this.saveIcon.classList.add("card__button_action_click");const e={keyword:this.data.keyword,title:this.data.title,text:this.data.description,date:this.dateCard.textContent,source:this.data.source.name,link:this.data.url,image:this.data.urlToImage};this.api.createArticle(e).then(e=>{console.log("Удалил: "+e),this.removeListernes()})}}setIconSaveState(e,t){t?(e.removeAttribute("disabled"),e.classList.add("card__button_action_save"),this.saveIcon.classList.remove("card__button_save")):(e.setAttribute("disabled",!0),e.classList.remove("card__button_action_save"),this.saveIcon.classList.add("card__button_save"))}_renderIconSave(){this.isAuth?(this.setIconSaveState(this.saveIcon,!0),this.setListeners(),this._isCheakArticles(this.data.url).then(e=>{e&&(this.saveIcon.classList.add("card__button_action_click"),this.data._id=e._id)})):this.setIconSaveState(this.saveIcon,!1)}_isCheakArticles(e){return this.api.getUserArticles().then(t=>t.data.find(t=>t.link===e))}setListeners(){this.saveIcon.addEventListener("click",this.saveArticle)}setListenersSavePage(){this.saveIcon.addEventListener("click",this.deleteCardSavePage)}removeListernes(){this.saveIcon.removeEventListener("click",this.saveArticle)}removeListernesSavePage(){this.saveIcon.removeEventListener("click",this.deleteCardSavePage)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(e,t,n,r,s,i,o){this.preloaderLoading=e,this.error=t,this.container=n,this.api=r,this.sectionNews=i,this.showMoreButton=o,this.createCard=s,this.showMore=this.showMore.bind(this)}showMore(){for(let e=0;e<3;e++){if(this.saveIndexCard===this.countArticles){this.showMoreButton.classList.add("news-content__button-uncover_theme_disable");break}this.addCard(this.createCard(this.arrResult[this.saveIndexCard])),this.saveIndexCard++}}renderResults(e){this.container.innerHTML="",this.api.getArticles(e).then(t=>{if(0===t.totalResults)throw new Error;this.showMoreButton.classList.remove("news-content__button-uncover_theme_disable"),this.sectionNews.classList.add("news-content_theme_active"),this.arrResult=t.articles.map(t=>(t.keyword=e,t)),this.countArticles=t.totalResults,this.saveIndexCard=0,this.showMore()}).catch(()=>{this.renderError(!0)}).finally(()=>{this.renderLoader(!1)})}renderArticlesSavePage(e){this.container.innerHTML="",e.forEach(e=>{this.addCard(this.createCard(e))})}addCard(e){this.container.appendChild(e)}renderLoader(e){e?this.preloaderLoading.classList.add("preloader_theme_active"):this.preloaderLoading.classList.remove("preloader_theme_active")}renderError(e){e?this.error.classList.add("preloader_theme_active"):this.error.classList.remove("preloader_theme_active")}setListenersList(){this.showMoreButton.addEventListener("click",this.showMore)}}},,function(e,t,n){"use strict";n.r(t);n(10);var r=n(3),s=n(4),i=n(5),o=n(6),a=n(7);const{myServerConfig:c}=n(0),{formLogIn:u,formSignUp:d,popupLogIn:l,popupSignUp:h,popupDone:_,buttonLogIn:g,buttonLogOutUser:m,buttonLoginInForm:p,buttonSignUp:f,buttonLoginInMessageDone:b,logInAnswerMessage:v,signUpAnswerMessage:S,buttonSavePage:y,userName:C,countArticles:L,keyWords:I,countKeyWords:M,container:w,mobileMenu:k,buttonCloseMenu:q,buttonBurger:A}=n(1),x=new r.a(c),P=new i.a,U=new a.a(void 0,void 0,w,x,(function(e){return new o.a(e,void 0,x,void 0).createArticleSavePage()}),w,void 0);new s.a({buttonSavePage:y,buttonUser:m,buttonLogIn:g,mobileMenu:k,buttonBurger:A,buttonCloseMenu:q}).render({isLoggedIn:!0,userName:JSON.parse(localStorage.getItem("user")).name}),m.addEventListener("click",(function(){P.clearUserInfo(),location.href="./index.html"})),x.getUserArticles().then(e=>{console.log(e),function(e){C.textContent=P.getUserData().name,L.textContent=e.length;const t=e.reduce((e,t)=>(void 0===e.find(e=>e===t.keyword)&&e.push(t.keyword),e),[]);if(0!==t.length)if(t.length>3){const e=t.slice(0,2);I.textContent=e.join(", ")+" и ",M.textContent=t.length-2+"-м другим"}else I.textContent=t.join(", ");else I.textContent="0 статей"}(e.data),U.renderArticlesSavePage(e.data)})},function(e,t,n){}]);